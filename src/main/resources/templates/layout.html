<!DOCTYPE html>
<html data-theme="{theme ?: 'light'}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{title ?: 'Home'} - Career Competency Matrix</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <link rel="stylesheet" href="/css/theme.css">
    <link rel="stylesheet" href="/css/matrix.css">
    <script src="https://unpkg.com/htmx.org@2.0.4"></script>
    <script src="/js/matrix.js"></script>
</head>
<body>
    <header class="container">
        <nav>
            <ul>
                <li><a href="/" class="brand"><strong>Competency Matrix</strong></a></li>
                <li><a href="/matrix">Matrix</a></li>
            </ul>
            <ul>
                <li>
                    <button hx-post="/theme"
                            hx-swap="none"
                            hx-on::after-request="toggleTheme()"
                            class="outline secondary"
                            id="theme-toggle">
                        {#if theme == 'dark'}
                        <span>Light Mode</span>
                        {#else}
                        <span>Dark Mode</span>
                        {/if}
                    </button>
                </li>
            </ul>
        </nav>
    </header>

    <main class="container">
        {#insert content}Default content{/insert}
    </main>

    <footer class="container">
        <hr>
        <p><small>Career Competency Matrix - A tool for visualizing career skill requirements</small></p>
    </footer>

    <dialog id="skill-modal">
        <article id="skill-modal-content">
        </article>
    </dialog>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);

            const btn = document.getElementById('theme-toggle');
            btn.innerHTML = newTheme === 'dark' ? 'Light Mode' : 'Dark Mode';
        }

        function openSkillModal() {
            const modal = document.getElementById('skill-modal');
            modal.showModal();
        }

        function closeSkillModal() {
            const modal = document.getElementById('skill-modal');
            modal.close();
        }

        document.addEventListener('htmx:afterSwap', function(evt) {
            if (evt.detail.target.id === 'skill-modal-content') {
                openSkillModal();
            }
        });

        document.getElementById('skill-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeSkillModal();
            }
        });
    </script>
</body>
</html>
