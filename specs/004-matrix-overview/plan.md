# Implementation Plan: Competency Matrix Table Overview

**Branch**: `004-matrix-overview` | **Date**: 2026-01-26 | **Spec**: [spec.md](spec.md)

## Summary

Create a matrix/table overview page displaying all skills as alphabetically-ordered rows and all roles as columns (grouped by role family, ordered by seniority). Each cell shows the required proficiency level. Users can hover over proficiency badges to view detailed descriptions in tooltips, filter by category via single-select dropdown, and navigate to existing detail pages by clicking role or skill names. The page is accessible via a top-level navigation link.

## Technical Context

**Language/Version**: Java 25
**Primary Dependencies**: Quarkus 3.30.6 (REST, Qute templating), htmx 2.0.4, Pico CSS 2
**Storage**: PostgreSQL 18.1 (via Panache JDBC)
**Testing**: JUnit 5, Quarkus Test, REST Assured, Testcontainers, Playwright
**Target Platform**: Server-side rendered web application (Linux/container deployment)
**Project Type**: Web application (monolith with server-side rendering)
**Performance Goals**: <2 seconds page load for matrix with 100 skills × 20 roles, <0.5s tooltip display
**Constraints**: <200ms p95 database query time, sticky headers must work smoothly during scrolling
**Scale/Scope**: Display up to 100 skills × 20 roles in single matrix view

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### I. Simplicity First ✅

- **Compliance**: Matrix view reuses existing data model (Skill, Role, RoleSkillRequirement) without new abstractions
- **Compliance**: Single-select category filter (simpler than multi-select)
- **Compliance**: Server-side rendering with htmx for interactivity (no SPA framework)
- **Compliance**: CSS-only tooltip positioning with JavaScript fallback for touch devices (standard web patterns)

### II. Test-First Development ✅

- **Compliance**: Integration tests will verify matrix rendering, filtering, and navigation before implementation
- **Compliance**: Unit tests for role grouping/ordering logic, skill sorting, tooltip data preparation
- **Compliance**: Playwright E2E tests for hover interactions, category filtering, sticky headers

### III. Monolith First Architecture ✅

- **Compliance**: New MatrixOverviewResource in existing Quarkus monolith
- **Compliance**: Reuses existing CompetencyService for data retrieval
- **Compliance**: No new services or dependencies beyond CSS/JavaScript for table interactivity

### IV. Data Integrity ✅

- **Compliance**: Read-only view using existing validated data model
- **Compliance**: Empty cells handled gracefully (left blank, no errors)
- **Compliance**: Database queries use existing repository layer with integrity constraints

### V. User-Centric Design ✅

- **Compliance**: Top-level navigation link (max 1 click to access from any page)
- **Compliance**: 2-second page load target meets specification SC-001
- **Compliance**: Sticky headers and fixed columns for large matrix usability
- **Compliance**: Responsive tooltip sizing (90% viewport) for mobile/desktop

**Gate Status**: ✅ **PASSED** - All Constitution principles satisfied, no violations requiring justification

## Project Structure

### Documentation (this feature)

```text
specs/004-matrix-overview/
├── plan.md              # This file
├── research.md          # Phase 0: CSS Grid/Flexbox patterns, tooltip best practices
├── data-model.md        # Phase 1: DTO for matrix view (extends existing model)
├── quickstart.md        # Phase 1: Developer setup for matrix page
├── contracts/           # Phase 1: API contract for /matrix endpoint
│   └── matrix-api.yaml
└── tasks.md             # Phase 2: Generated by /speckit.tasks (not yet created)
```

### Source Code (repository root)

```text
src/main/java/nl/leonw/competencymatrix/
├── model/                              # Existing entities (no changes)
│   ├── Skill.java
│   ├── Role.java
│   ├── RoleSkillRequirement.java
│   ├── CompetencyCategory.java
│   └── ProficiencyLevel.java
├── repository/                         # Existing repositories (no changes)
│   ├── SkillRepository.java
│   ├── RoleRepository.java
│   └── RoleSkillRequirementRepository.java
├── service/
│   └── CompetencyService.java         # Extend with matrix data methods
├── resource/
│   ├── MatrixOverviewResource.java    # NEW: /matrix endpoint
│   ├── HomeResource.java              # Update navigation link
│   ├── RoleResource.java              # Existing (linked from matrix)
│   └── CompareResource.java           # Existing
└── dto/                                # NEW: DTOs for matrix view
    ├── MatrixViewModel.java
    ├── MatrixRow.java
    └── MatrixCell.java

src/main/resources/
├── templates/
│   ├── layout.html                    # Update with matrix nav link
│   ├── matrix-overview.html           # NEW: Main matrix page
│   └── fragments/
│       └── matrix-tooltip.html        # NEW: Tooltip content fragment
└── META-INF/resources/
    ├── css/
    │   ├── theme.css                  # Existing
    │   └── matrix.css                 # NEW: Matrix-specific styles
    └── js/
        └── matrix.js                  # NEW: Tooltip and filter interactions

src/test/java/nl/leonw/competencymatrix/
├── resource/
│   └── MatrixOverviewResourceTest.java # NEW: Integration tests
├── service/
│   └── CompetencyServiceTest.java      # Extend with matrix tests
└── e2e/
    └── MatrixOverviewE2ETest.java      # NEW: Playwright tests
```

**Structure Decision**: Web application with server-side rendering (Quarkus + Qute). Frontend uses htmx for partial updates (category filtering) and vanilla JavaScript for tooltip/scroll interactions. Follows existing project structure with JAX-RS resources, service layer, and Qute templates.

## Complexity Tracking

*No Constitution violations - this section intentionally left empty.*
